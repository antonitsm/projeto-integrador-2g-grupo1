{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Registros - Ecolmeia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{% static 'dashboard/css/tudo_registros.css' %}">
</head>
<body>

<header>
  {% include './header.html' %}
</header>

<main>
  <div class="container">

    <!-- Cabeçalho da seção -->
    <div class="section-header">
      <h2>Lista de Registros</h2>
      <a href="{% url 'observacao' %}" class="btn-novo-registro">+ Novo Registro</a>
    </div>

    <!-- Filtros -->
    <div class="filtros">
      <form method="get" id="form-filtros">
        <label for="colmeia">Colmeia:</label>
        <select name="colmeia" id="colmeia">
          <option value="">Todas</option>
          {% for colmeia in colmeias %}
            <option value="{{ colmeia.id }}" {% if request.GET.colmeia == colmeia.id|stringformat:"s" %}selected{% endif %}>
              {{ colmeia.nome }}
            </option>
          {% endfor %}
        </select>

        <label for="ordem">Data:</label>
        <select name="ordem" id="ordem">
          <option value="desc" {% if request.GET.ordem == "desc" %}selected{% endif %}>Mais recente</option>
          <option value="asc" {% if request.GET.ordem == "asc" %}selected{% endif %}>Mais antigo</option>
        </select>

        <button type="submit" class="btn-filtro">Filtrar</button>
      </form>
    </div>

    <!-- Lista de registros -->
    <div class="registros-lista">
      {% for registro in registros %}
        <div class="registro-wrapper">

          <!-- Item principal -->
          <div class="registro-item">
            <div class="registro-info">
              <h3>{{ registro.titulo }}</h3>
              <p class="registro-data">Data: {{ registro.data_observacao }}</p>
              <p class="registro-colmeia">Colmeia: {{ registro.colmeia.nome }}</p>
            </div>

            <div class="registro-arrow">▶</div>

            <!-- Botões (Editar + Excluir) -->
            <div class="registro-acoes">
              <a href="{% url 'editar_registro' registro.id %}" class="btn-editar">Editar</a>

              <form action="{% url 'excluir_registro' registro.id %}" method="POST" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn-excluir" onclick="return confirm('Tem certeza que deseja excluir este registro?');">
                  Excluir
                </button>
              </form>
            </div>
          </div>

          <!-- Detalhes -->
          <div class="registro-detalhes">
            <p><span class="observacoes-label">Observações:</span> {{ registro.observacoes }}</p>
          </div>

        </div>
      {% empty %}
        <!-- Mensagem quando não há registros -->
        <div class="sem-registros">
          <p>Nenhum registro encontrado.</p>
          <a href="{% url 'observacao' %}" class="btn-novo-registro">Criar Primeiro Registro</a>
        </div>
      {% endfor %}
    </div>

  </div>
</main>

<footer>
  {% include './footer.html' %}
</footer>

<script src="{% static 'dashboard/js/tudo_registros.js' %}"></script>
</body>
</html>
