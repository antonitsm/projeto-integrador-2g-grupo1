{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Minhas Colmeias - Ecolmeia</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- CSS -->
  <link rel="stylesheet" href="{% static 'dashboard/css/minhas_colmeias.css' %}">
</head>

<body>
  
  {% include './header.html' %}

  <!-- ===== MAIN CONTENT ===== -->
  <main class="main-content">
    <div class="container">
      <!-- Título principal mantido centralizado -->
      <h1 class="page-title">Minhas Colmeias</h1>

      <!-- Botão de adicionar colmeia -->
      <section class="adicionar-section">
        <a href="{% url 'dados' %}" class="btn-adicionar-colmeia">
          + Adicionar Colmeia
        </a>
      </section>

      {% if colmeias %}
      <section class="colmeias-section">
        <div class="colmeias-lista">
          {% for colmeia in colmeias %}
          <div class="colmeia-card" data-colmeia="{{ colmeia.id }}">
            <!-- Header da colmeia com nome no canto superior esquerdo -->
            <div class="colmeia-header">
              <h2 class="colmeia-nome">{{ colmeia.nome }}</h2>
            </div>

            <!-- Botões de ação reorganizados em grid de 3 colunas -->
            <div class="colmeia-actions">
              <!-- Editar -->
              <a href="{% url 'edit_hive' colmeia.id %}" class="btn-action btn-editar">Editar</a>

              <!-- Ver Dados (collapse) -->
              <button class="btn-action btn-registro" 
                      type="button" 
                      data-bs-toggle="collapse" 
                      data-bs-target="#dados-{{ colmeia.id }}" 
                      aria-expanded="false" 
                      aria-controls="dados-{{ colmeia.id }}">
                Ver Dados
              </button>

              <!-- Excluir -->
              <form action="{% url 'delete_hive' colmeia.pk %}" method="POST" onsubmit="return confirmarExclusao();">
                {% csrf_token %}
                <button type="submit" class="btn-action btn-producao">Excluir</button>
              </form>
            </div>

            <!-- Collapse dos Dados -->
            <div class="colmeia-detalhes collapse" id="dados-{{ colmeia.id }}">
              <div class="collapse-content">
                <p><strong>Temperatura:</strong> {{ colmeia.temperatura }} °C</p>
                <p><strong>Peso:</strong> {{ colmeia.peso }} kg</p>
                <p><strong>Umidade:</strong> {{ colmeia.umidade }} %</p>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </section>
      {% else %}
      <section class="sem-colmeias">
        <p>Você ainda não possui nenhuma colmeia cadastrada.</p>
        <a href="{% url 'dados' %}" class="btn-primeira-colmeia">
          Cadastrar Primeira Colmeia
        </a>
      </section>
      {% endif %}
    </div>
  </main>
  
  <!-- FOOTER -->
  <footer>
    {% include './footer.html' %}
  </footer>

  <!-- Modal de Confirmação -->
  <div id="modal-confirmacao" class="modal">
    <div class="modal-conteudo">
      <h3>Confirmar Exclusão</h3>
      <p>Tem certeza de que deseja excluir esta colmeia?</p>
      <div class="botoes-modal">
        <button class="btn-cancelar" onclick="fecharModal()">Cancelar</button>
        <button class="btn-confirmar" onclick="confirmarExclusao()">Excluir</button>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- JS -->
  <script src="{% static 'dashboard/js/minhas_colmeias.js' %}"></script>
</body>
</html>
